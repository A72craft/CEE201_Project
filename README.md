# CEE201_project
### [Github repository for this project](https://github.com/A72craft/CEE201_Project.git)
## Introduction:
In this project we are asked to come up with a comprehensive covid-19 plan which is made of three parts: opening testing centers, providing the testing material, and picking up all the tests. In the following three parts we will be formatting the problem given and solving it with python.
## Part 1. Opening testing centers (facility location problem)

### Decision variables

	Xj = 1 if site is selected and 0 if it is not.
### Parameters:

	i =0,1, 2 ,…,9 candidate site indices
	j =0,1, 2 ,…,29 neighborhood indices
	Cij = the cost(distance) between the site and the neighborhood
	Nij = 1 if the neighborhood j will go to testing site i, 0 if not
### Objective:

The objective is that the sum of the cost(distance) needs to be minimized. 

	MINIMIZE
	93.50935782*C_(0,_0) + 43.68065934*C_(0,_1) + 44.04543109*C_(0,_2) + 14.14213562*C_(0,_3) + 39.11521443*C_(0,_4) + 53.15072906*C_(0,_5) + 35.4682957*C_(0,_6) + 56.60388679*C_(0,_7) + 41.43669871*C_(0,_8) + 78.23042886*C_(0,_9) + 9.486832981*C_(1,_0) + 64.63745044*C_(1,_1) + 58.25804665*C_(1,_2) + 113.1459235*C_(1,_3) + 78.89233169*C_(1,_4) + 75.95393341*C_(1,_5) + 90.55385138*C_(1,_6) + 46.75467891*C_(1,_7) + 80.5294977*C_(1,_8) + 37.01351105*C_(1,_9) + 61.3514466*C_(10,_0) + 76.15773106*C_(10,_1) + 58.30951895*C_(10,_2) + 97.01546269*C_(10,_3) + 89.18520057*C_(10,_4) + 30.08321791*C_(10,_5) + 97.29337079*C_(10,_6) + 63.2455532*C_(10,_7) + 92.65527508*C_(10,_8) + 34.0*C_(10,_9) + 75.60423269*C_(11,_0) + 20.59126028*C_(11,_1) + 27.85677655*C_(11,_2) + 30.52867504*C_(11,_3) + 15.8113883*C_(11,_4) + 54.7813837*C_(11,_5) + 17.49285568*C_(11,_6) + 36.87817783*C_(11,_7) + 18.78829423*C_(11,_8) + 66.48308055*C_(11,_9) + 37.85498646*C_(12,_0) + 38.27531842*C_(12,_1) + 44.10215414*C_(12,_2) + 89.0*C_(12,_3) + 48.01041554*C_(12,_4) + 79.12016178*C_(12,_5) + 58.89821729*C_(12,_6) + 30.41381265*C_(12,_7) + 48.27007354*C_(12,_8) + 54.56189146*C_(12,_9) + 40.22437072*C_(13,_0) + 17.72004515*C_(13,_1) + 13.03840481*C_(13,_2) + 65.19202405*C_(13,_3) + 32.984845*C_(13,_4) + 49.24428901*C_(13,_5) + 44.27188724*C_(13,_6) + 1.414213562*C_(13,_7) + 35.51056181*C_(13,_8) + 37.33630941*C_(13,_9) + 68.41052551*C_(14,_0) + 18.86796226*C_(14,_1) + 36.7151195*C_(14,_2) + 54.91812087*C_(14,_3) + 13.03840481*C_(14,_4) + 74.51845409*C_(14,_5) + 21.02379604*C_(14,_6) + 34.23448554*C_(14,_7) + 11.18033989*C_(14,_8) + 70.71067812*C_(14,_9) + 80.08120878*C_(15,_0) + 27.65863337*C_(15,_1) + 45.22167622*C_(15,_2) + 50.009999*C_(15,_3) + 15.0*C_(15,_4) + 80.99382693*C_(15,_5) + 15.13274595*C_(15,_6) + 45.0*C_(15,_7) + 11.40175425*C_(15,_8) + 81.22191822*C_(15,_9) + 62.09669879*C_(16,_0) + 15.62049935*C_(16,_1) + 32.80243893*C_(16,_2) + 58.24087911*C_(16,_3) + 15.8113883*C_(16,_4) + 71.42128534*C_(16,_5) + 25.8069758*C_(16,_6) + 28.63564213*C_(16,_7) + 15.26433752*C_(16,_8) + 65.11528238*C_(16,_9) + 65.21502894*C_(17,_0) + 27.73084925*C_(17,_1) + 17.4642492*C_(17,_2) + 42.48529157*C_(17,_3) + 34.82814953*C_(17,_4) + 31.78049716*C_(17,_5) + 40.31128874*C_(17,_6) + 31.57530681*C_(17,_7) + 38.41874542*C_(17,_8) + 48.87739764*C_(17,_9) + 74.27651042*C_(18,_0) + 23.34523506*C_(18,_1) + 25.0*C_(18,_2) + 30.41381265*C_(18,_3) + 22.82542442*C_(18,_4) + 47.4341649*C_(18,_5) + 25.23885893*C_(18,_6) + 36.40054945*C_(18,_7) + 26.07680962*C_(18,_8) + 62.39390996*C_(18,_9) + 91.92388155*C_(19,_0) + 39.92492956*C_(19,_1) + 42.44997055*C_(19,_2) + 13.03840481*C_(19,_3) + 34.0*C_(19,_4) + 56.00892786*C_(19,_5) + 29.73213749*C_(19,_6) + 54.20332093*C_(19,_7) + 36.12478374*C_(19,_8) + 78.29431652*C_(19,_9) + 96.9381246*C_(2,_0) + 45.88027899*C_(2,_1) + 47.42362281*C_(2,_2) + 10.04987562*C_(2,_3) + 40.01249805*C_(2,_4) + 57.218878*C_(2,_5) + 35.17101079*C_(2,_6) + 59.6405902*C_(2,_7) + 42.04759208*C_(2,_8) + 82.15229759*C_(2,_9) + 51.2445119*C_(20,_0) + 23.02172887*C_(20,_1) + 35.35533906*C_(20,_2) + 71.51223672*C_(20,_3) + 29.52964612*C_(20,_4) + 74.06078585*C_(20,_5) + 40.0*C_(20,_6) + 25.49509757*C_(20,_7) + 29.41088234*C_(20,_8) + 59.61543424*C_(20,_9) + 32.80243893*C_(21,_0) + 53.66563146*C_(21,_1) + 56.56854249*C_(21,_2) + 104.7091209*C_(21,_3) + 64.20280368*C_(21,_4) + 87.66413178*C_(21,_5) + 75.16648189*C_(21,_6) + 42.42640687*C_(21,_7) + 64.5368112*C_(21,_8) + 56.60388679*C_(21,_9) + 67.08203932*C_(22,_0) + 72.71863585*C_(22,_1) + 54.91812087*C_(22,_2) + 88.20430828*C_(22,_3) + 84.58132182*C_(22,_4) + 21.0*C_(22,_5) + 91.70605214*C_(22,_6) + 62.22539674*C_(22,_7) + 88.141931*C_(22,_8) + 38.83297568*C_(22,_9) + 50.11985634*C_(23,_0) + 30.52867504*C_(23,_1) + 12.80624847*C_(23,_2) + 59.05929224*C_(23,_3) + 43.01162634*C_(23,_4) + 26.62705391*C_(23,_5) + 51.4781507*C_(23,_6) + 23.40939982*C_(23,_7) + 46.4865572*C_(23,_8) + 32.24903099*C_(23,_9) + 59.09314681*C_(24,_0) + 5.656854249*C_(24,_1) + 23.32380758*C_(24,_2) + 52.80151513*C_(24,_3) + 13.03840481*C_(24,_4) + 61.55485359*C_(24,_5) + 24.69817807*C_(24,_6) + 22.09072203*C_(24,_7) + 14.86606875*C_(24,_8) + 58.13776741*C_(24,_9) + 57.14017851*C_(25,_0) + 25.0*C_(25,_1) + 39.40812099*C_(25,_2) + 70.60453243*C_(25,_3) + 28.16025568*C_(25,_4) + 78.40918314*C_(25,_5) + 37.58989226*C_(25,_6) + 30.8058436*C_(25,_7) + 27.31300057*C_(25,_8) + 65.55150647*C_(25,_9) + 22.09072203*C_(26,_0) + 72.13875519*C_(26,_1) + 68.26419266*C_(26,_2) + 122.1474519*C_(26,_3) + 85.42833254*C_(26,_4) + 88.68483523*C_(26,_5) + 97.0051545*C_(26,_6) + 55.6057551*C_(26,_7) + 86.60831369*C_(26,_8) + 50.03998401*C_(26,_9) + 80.36168241*C_(27,_0) + 57.70615219*C_(27,_1) + 73.00684899*C_(27,_2) + 95.00526301*C_(27,_3) + 55.31726674*C_(27,_4) + 112.0044642*C_(27,_5) + 60.03332408*C_(27,_6) + 63.63961031*C_(27,_7) + 52.77309921*C_(27,_8) + 95.7183368*C_(27,_9) + 12.04159458*C_(28,_0) + 45.61797891*C_(28,_1) + 37.53664876*C_(28,_2) + 92.65527508*C_(28,_3) + 60.53924347*C_(28,_4) + 58.0*C_(28,_5) + 72.09022125*C_(28,_6) + 26.92582404*C_(28,_7) + 62.62587325*C_(28,_8) + 23.85372088*C_(28,_9) + 88.58893836*C_(29,_0) + 31.30495168*C_(29,_1) + 44.40720662*C_(29,_2) + 30.06659276*C_(29,_3) + 17.02938637*C_(29,_4) + 73.05477397*C_(29,_5) + 5.830951895*C_(29,_6) + 50.15974482*C_(29,_7) + 16.40121947*C_(29,_8) + 83.18653737*C_(29,_9) + 54.23098745*C_(3,_0) + 49.0*C_(3,_1) + 59.20304046*C_(3,_2) + 96.56603958*C_(3,_3) + 54.12023651*C_(3,_4) + 96.17692031*C_(3,_5) + 63.1585307*C_(3,_6) + 46.61544808*C_(3,_7) + 53.14132102*C_(3,_8) + 72.9177619*C_(3,_9) + 13.45362405*C_(4,_0) + 62.93647591*C_(4,_1) + 51.623638*C_(4,_2) + 106.606754*C_(4,_3) + 78.16009212*C_(4,_4) + 60.08327554*C_(4,_5) + 89.49301649*C_(4,_6) + 43.96589587*C_(4,_7) + 80.52328856*C_(4,_8) + 19.92485885*C_(4,_9) + 52.63078947*C_(5,_0) + 15.03329638*C_(5,_1) + 28.60069929*C_(5,_2) + 64.07807737*C_(5,_3) + 22.8035085*C_(5,_4) + 67.62396025*C_(5,_5) + 33.9411255*C_(5,_6) + 21.02379604*C_(5,_7) + 23.34523506*C_(5,_8) + 57.00877125*C_(5,_9) + 77.82673063*C_(6,_0) + 20.61552813*C_(6,_1) + 35.0*C_(6,_2) + 36.67424164*C_(6,_3) + 6.403124237*C_(6,_4) + 67.08203932*C_(6,_5) + 6.08276253*C_(6,_6) + 39.56008089*C_(6,_7) + 7.071067812*C_(6,_8) + 73.43704787*C_(6,_9) + 57.38466694*C_(7,_0) + 19.20937271*C_(7,_1) + 8.062257748*C_(7,_2) + 47.80167361*C_(7,_3) + 29.54657341*C_(7,_4) + 37.01351105*C_(7,_5) + 37.48332963*C_(7,_6) + 21.84032967*C_(7,_7) + 33.10589071*C_(7,_8) + 44.59820624*C_(7,_9) + 51.4781507*C_(8,_0) + 5.830951895*C_(8,_1) + 15.55634919*C_(8,_2) + 56.30275304*C_(8,_3) + 20.88061302*C_(8,_4) + 54.56189146*C_(8,_5) + 32.31098884*C_(8,_6) + 13.34166406*C_(8,_7) + 23.34523506*C_(8,_8) + 49.09175083*C_(8,_9) + 76.2758153*C_(9,_0) + 35.6931366*C_(9,_1) + 28.46049894*C_(9,_2) + 34.20526275*C_(9,_3) + 38.83297568*C_(9,_4) + 34.13209633*C_(9,_5) + 41.23105626*C_(9,_6) + 42.44997055*C_(9,_7) + 42.20189569*C_(9,_8) + 58.6003413*C_(9,_9)

### Constraints:

A total of 4 testing sites will be opened:

	X0+X1+X2+X3+X4+X5+X6+X7+X8+X9 = 4
Each neighborhood will go to only one testing site:

	j00:N000+N100+N200+N300+N400+N500+N600+N700+N800+N900 = 1
	j01:N001+N101+N201+N301+N401+N501+N601+N701+N801+N901 = 1
	j02:N002+N102+N202+N302+N402+N502+N602+N702+N802+N902 = 1
	.
	.
	.
	j29:N029+N129+N229+N329+N429+N529+N629+N729+N829+N929 = 1
The capacity of the testing site will not exceed 25000

	Placeholder
	
### Code
Importing packages
```python
import pulp #pulp will be used to produce the problem
import numpy as np
```
Problem information
```python
#The capacity of the testing site
capacity = [25000,25000,25000,25000,25000,25000,25000,25000,25000,25000,] 
#The demand of the neighborhood
demand = [2500,2000,3000,1000,2500,2500,4000,2000,1000,500, 
          2500,2000,3000,5000,2500,2000,1500,1000,1000,2000,
          3000,1500,2500,3500,3000,2500,2000,1500,1500,3000]
Cij = #This is a 30*10 matrix
np.array([[93.50935782,43.68065934,44.04543109,14.14213562,39.11521443,53.15072906,
                 35.4682957,56.60388679,41.43669871, 78.23042886], [9.486832981,
                64.63745044, 58.25804665, 113.1459235, 78.89233169,75.95393341,
                90.55385138, 46.75467891, 80.5294977, 37.01351105],[96.9381246,
                45.88027899,47.42362281, 10.04987562, 40.01249805, 57.218878,
                35.17101079, 59.6405902, 42.04759208,82.15229759], [54.23098745,
                49.0, 59.20304046, 96.56603958, 54.12023651, 96.17692031,63.1585307,
                46.61544808, 53.14132102, 72.9177619], [13.45362405, 62.93647591,
                51.623638, 106.606754,78.16009212, 60.08327554, 89.49301649,
                43.96589587, 80.52328856, 19.92485885], [52.63078947,15.03329638,
                28.60069929,64.07807737,22.8035085,67.62396025,33.9411255,21.02379604,
                23.34523506, 57.00877125], [77.82673063, 20.61552813, 35.0,
                36.67424164, 6.403124237,67.08203932, 6.08276253, 39.56008089,
                7.071067812, 73.43704787], [57.38466694, 19.20937271,8.062257748,
                47.80167361, 29.54657341, 37.01351105, 37.48332963, 21.84032967,
                33.10589071,44.59820624], [51.4781507, 5.830951895, 15.55634919,
                56.30275304, 20.88061302, 54.56189146,32.31098884, 13.34166406,
                23.34523506, 49.09175083], [76.2758153, 35.6931366, 28.46049894,
                34.20526275, 38.83297568, 34.13209633, 41.23105626, 42.44997055,
                42.20189569, 58.6003413],[61.3514466, 76.15773106, 58.30951895,
                97.01546269, 89.18520057, 30.08321791, 97.29337079,63.2455532,
                92.65527508, 34.0],[75.60423269,20.59126028,27.85677655,30.52867504,
                15.8113883, 54.7813837, 17.49285568, 36.87817783, 18.78829423,
                66.48308055],[37.85498646, 38.27531842, 44.10215414, 89.0,
                48.01041554, 79.12016178, 58.89821729,30.41381265, 48.27007354,
                54.56189146], [40.22437072, 17.72004515, 13.03840481, 65.19202405,
                32.984845, 49.24428901, 44.27188724, 1.414213562, 35.51056181,
                37.33630941], [68.41052551,18.86796226, 36.7151195, 54.91812087,
                13.03840481, 74.51845409, 21.02379604, 34.23448554,11.18033989,
                70.71067812], [80.08120878, 27.65863337, 45.22167622,
                50.009999, 15.0,80.99382693, 15.13274595, 45.0, 11.40175425,
                81.22191822], [62.09669879, 15.62049935,32.80243893,
                58.24087911, 15.8113883, 71.42128534, 25.8069758,
                28.63564213, 15.26433752,65.11528238], [65.21502894,
                27.73084925, 17.4642492, 42.48529157, 34.82814953, 31.78049716,
                40.31128874, 31.57530681, 38.41874542, 48.87739764],
                [74.27651042, 23.34523506, 25.0,30.41381265, 22.82542442,
                47.4341649, 25.23885893, 36.40054945, 26.07680962, 62.39390996],
                [91.92388155, 39.92492956, 42.44997055, 13.03840481,
                34.0, 56.00892786, 29.73213749,54.20332093, 36.12478374,
                78.29431652], [51.2445119, 23.02172887, 35.35533906, 71.51223672,
                29.52964612, 74.06078585, 40.0, 25.49509757, 29.41088234,
                59.61543424], [32.80243893,53.66563146, 56.56854249,
                104.7091209, 64.20280368, 87.66413178, 75.16648189,
                42.42640687, 64.5368112, 56.60388679], [67.08203932,
                72.71863585, 54.91812087,88.20430828, 84.58132182, 21.0,
                91.70605214, 62.22539674, 88.141931, 38.83297568],
                [50.11985634, 30.52867504, 12.80624847, 59.05929224,
                43.01162634, 26.62705391,51.4781507, 23.40939982,
                46.4865572, 32.24903099], [59.09314681, 5.656854249,
                23.32380758, 52.80151513, 13.03840481, 61.55485359,
                24.69817807, 22.09072203,14.86606875, 58.13776741],
                [57.14017851, 25.0, 39.40812099, 70.60453243, 28.16025568,
                78.40918314, 37.58989226, 30.8058436, 27.31300057,
                65.55150647], [22.09072203,72.13875519, 68.26419266,
                122.1474519, 85.42833254, 88.68483523, 97.0051545, 55.6057551,
                86.60831369, 50.03998401], [80.36168241, 57.70615219,
                73.00684899, 95.00526301,55.31726674, 112.0044642,
                60.03332408, 63.63961031, 52.77309921, 95.7183368],
                [12.04159458, 45.61797891, 37.53664876, 92.65527508,
                60.53924347, 58.0, 72.09022125,26.92582404, 62.62587325,
                23.85372088], [88.58893836, 31.30495168, 44.40720662,
                30.06659276, 17.02938637, 73.05477397, 5.830951895,
                50.15974482, 16.40121947, 83.18653737]])
```
```python
#create the model
model = pulp.LpProblem("part1",pulp.LpMinimize)
#set Cij,which is whether the j neighborhood will go to the i site
C = pulp.LpVariable.dicts("C",((i, j) for i in range(30) 
						  for j in range(10)),lowBound=0,cat='Binary')
#set N, which is whether the i site will be open
N = pulp.LpVariable.dicts("N",((i) for i in range(10)),cat='Binary')
#each neighborhood will only go to one testing site
for i in range(30):
    model += pulp.lpSum([C[i,j] for j in range(10)]) == 1
#the capacity will not be exceeded
for j in range(10):
    model += pulp.lpSum([demand[i]*C[i,j]  for i in range(30)]) <= N[j]*capacity[j]
#Only 4 testing sites will open
model += pulp.lpSum([N[i] for i in range(10)]) == 4
#Minimize the sum of the distances
model += pulp.lpSum([C[i,j]*Cij[i,j] for i in range(30) for j in range(10)])
model.solve()
#create the solution matrix,where X is the C matrix and Y the N matrix
X = np.zeros(30*10)
Y = np.zeros(10)
i = 0
#assign the variables to the matrix
for variable in model.variables():
    if i<300:
        X[i]= variable.varValue
    else:
        Y[i-300] = variable.varValue
    i += 1
X = np.reshape(X,(30,10))
print(model)
print('C =\n',X)
print('N =', Y)
print('Optimal objective value:',pulp.value(model.objective))
```
## Part 2. Providing testing materials (transportation problem)
## Part 3. Picking up all the tests (traveling salesperson problem)
```python
import pulp

# Step 1: Uncomment the code for Step 1 and then modify it
my_lp_problem = pulp.LpProblem("My LP Problem", pulp.LpMaximize)
x1 =  pulp.LpVariable('x1', lowBound=0, cat='Continuous')
x2 =  pulp.LpVariable('x2', lowBound=0, cat='Continuous')
my_lp_problem +=  0.8 * x1 -2.2* x2, "Z"
my_lp_problem +=  -6*x1 + 3*x2 <=12
my_lp_problem += 4*x1 - 2*x2 <=24
my_lp_problem += 1 * x1 -1*x2 <=5
my_lp_problem += x2<=6


# Step 2: When you finished the "Step 1", modify the code bellow, define the 
#required variables.
my_lp_problem.solve()
print(" x1* = {}".format(x1.varValue))
print(" x2* = {}".format(x2.varValue))
print(" Z* = ",pulp.value(my_lp_problem.objective))
x1_Optimal_Value = x1.varValue
x2_Optimal_Value = x2.varValue
z_Optimal_Value = pulp.value(my_lp_problem.objective)
```
## Misc
### Importing excel sheet data to a array(part 1)
```python
import xlrd
with xlrd.open_workbook('data.xlsx') as data:
    sheet = data.sheet_by_index(0)
    rows = []
    for row in sheet.get_rows():
        rows.append([cell.value for cell in row])
print(rows)
```
